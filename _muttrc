# Set private settings
source $HOME/.mutt_secrets

set imap_authenticators=login
set imap_user=$my_username
set imap_pass=$my_password
set spoolfile="imaps://imap.fastmail.com"
set folder="imaps://imap.fastmail.com/INBOX"
set record="imaps://imap.fastmail.com/Sent"
set postponed="imaps://imap.fastmail.com/Drafts"
set mbox="imaps://imap.fastmail.com/Archive"
set trash="imaps://imap.fastmail.com/Trash"
set read_inc=1000
set write_inc=1000
set mail_check=5

set text_flowed=yes

set smtp_authenticators="login"
set smtp_pass=$my_password
set smtp_url="smtps://$my_username@smtp.fastmail.com:465/"
set ssl_force_tls=yes
set ssl_starttls=yes

# Respond as the message addressee, without exposing your real name
set reverse_name=yes
set reverse_realname=no

set sort=reverse-date-received
set mailcap_path = ~/.mailcap
auto_view text/html
set wait_key=no

save-hook . ~/Documents/Mail/%a
unset confirmappend
unset confirmcreate
set pager_stop

# Keyboard shortcuts:

bind index <esc>V noop
bind index <esc>v noop
bind index <esc><space> collapse-all
bind index <space> collapse-thread
bind index x sync-mailbox

bind index \Cn noop
bind index \Cp noop
bind alias,index,browser,query G last-entry
bind pager G bottom
bind alias,index,browser,query gg first-entry
bind pager gg top

bind pager <up> previous-line
bind pager <down> next-line

bind index n search-next
bind index N search-opposite

bind index { previous-thread
bind pager { half-up

bind index } next-thread
bind pager } half-down

bind index,pager A create-alias
bind index,pager R group-reply

# Readline keys for command history
bind editor <up> history-up
bind editor \Cp history-up
bind editor <down> history-down
bind editor \Cn history-down

# Mailbox shortcuts
macro index,pager ,d "<change-folder>$postponed<enter><buffy-list>" "Open drafts"
macro index,pager ,i "<change-folder>$spoolfile<enter><buffy-list>" "Open inbox"
macro index,pager ,s "<change-folder>$record<enter><buffy-list>"    "Open sent mail"
macro index,pager ,t "<change-folder>$trash<enter><buffy-list>"     "Open trash"

macro attach s "<save-entry><bol>~/Downloads/<eol>" "Save attachment to ~/Downloads/"
macro attach S "<tag-prefix-cond><save-entry><bol>~/Downloads/<eol><enter>" "Save tagged attachments to ~/Downloads/"

macro index,pager V "<shell-escape>mkdir -p $HOME/.cache/mutt<enter>v<search>\\[text/html<enter><pipe-entry>iconv -c --to-code=UTF8 > $HOME/.cache/mutt/browse_message.html<enter><shell-escape>firefox $HOME/.cache/mutt/browse_message.html<enter>q" "Open attachment with Firefox"
